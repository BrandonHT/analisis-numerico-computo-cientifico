
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3.2 Algoritmos de descenso y búsqueda de línea en Unconstrained Convex Optimization (UCO)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.3 Ejemplos de problemas UCO, introducción a Constrained Inequality and Equality Optimization (CIEO) y puntos interiores" href="../3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html" />
    <link rel="prev" title="3.1 Definición de problemas de optimización, conjuntos y funciones convexas" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    Optimización
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  1. Cómputo científico
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../1.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  2. Cómputo matricial
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../2.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../2.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../2.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../2.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  3. Optimización convexa y ecuaciones no lineales
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  4. Optimización en redes y programación lineal
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../4.optimizacion_en_redes_y_prog_lineal/4.1/Programacion_lineal_y_metodo_simplex.html">
   4.1 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../4.optimizacion_en_redes_y_prog_lineal/4.2/Definiciones_generales_de_flujo_en_redes.html">
   4.2 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../4.optimizacion_en_redes_y_prog_lineal/4.3/Ejemplo_metodo_simplex_de_redes.html">
   4.3 Ejemplo del método símplex de redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../4.optimizacion_en_redes_y_prog_lineal/4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html">
   4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../4.optimizacion_en_redes_y_prog_lineal/4.5/Metodo_primal_dual_de_BL.html">
   4.5 Método primal-dual de barrera logarítmica (BL)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  5. Optimización de código
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../5.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.html">
   5.1 Introducción a optimización de código
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../5.optimizacion_de_codigo/5.2/Herramientas_de_lenguajes_y_del_SO_para_perfilamiento_e_implementaciones_de_BLAS.html">
   5.2 Herramientas de lenguajes de programación y del sistema operativo para perfilamiento e implementaciones de BLAS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../5.optimizacion_de_codigo/5.3/Compilacion_a_C.html">
   5.3 Compilación a C
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../5.optimizacion_de_codigo/5.4/Computo_en_paralelo_usando_CPUS_en_SMC.html">
   5.4 Cómputo en paralelo usando CPUs en un sistema de memoria compartida (SMC)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../5.optimizacion_de_codigo/5.5/Computo_en_paralelo_usando_GPUS_en_SMC.html">
   5.5 Cómputo en paralelo usando GPUs en un sistema de memoria compartida (SMC)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  6. Algoritmos de optimización convexa
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../6.algoritmos_optimizacion_convexa/6.1/Metodo_de_descenso_mas_pronunciado_para_UCO.html">
   6.1 Método de descenso más pronunciado para
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../6.algoritmos_optimizacion_convexa/6.2/Problemas_CECO.html">
   6.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../6.algoritmos_optimizacion_convexa/6.3/Problemas_CIECO.html">
   6.3 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  7. Temas selectos
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../7.temas_selectos/7.1/Optimizacion_estocastica.html">
   7.1 Optimización estocástica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../7.temas_selectos/7.2/Metodos_cuasi_Newton.html">
   7.2 Métodos cuasi Newton
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/3.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/3.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplos-de-problemas-de-optimizacion-small-scale">
   Ejemplos de problemas de optimización
   <em>
    small scale
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f-o">
     ¿Por qué fue un poco complicado determinar el conjunto de mínimos de
     <span class="math notranslate nohighlight">
      \(f_o\)
     </span>
     ?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-importante">
     Ejemplo importante
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodos-de-descenso">
   Métodos de descenso
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-de-funcion-objetivo-convexa">
     Ejemplo de función objetivo convexa
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#condicion-para-que-un-paso-o-direccion-de-busqueda-sea-de-descenso">
     Condición para que un paso o dirección de búsqueda sea de descenso
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplos-de-direcciones-de-descenso">
     Ejemplos de direcciones de descenso
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#continuando-con-el-ejemplo-anterior">
     Continuando con el ejemplo anterior
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resolviendo-el-problema-con-cvxpy">
     Resolviendo el problema con
     <em>
      CVXPY
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tamano-o-longitud-de-paso">
   Tamaño o longitud de paso
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Continuando con el ejemplo anterior
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#por-que-funciona-lo-anterior">
     ¿Por qué funciona lo anterior?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-de-busqueda-de-linea-por-backtracking">
   Método de búsqueda de línea por
   <em>
    backtracking
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#descenso-suficiente">
     Descenso suficiente
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algoritmo-busqueda-de-linea-por-backtracking">
     Algoritmo: búsqueda de línea por
     <em>
      backtracking
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#funcion-en-python-para-el-metodo-de-backtracking">
   Función en Python para el método de
   <em>
    backtracking
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algoritmo-metodo-general-de-descenso-para-problemas-uco">
   Algoritmo: método general de descenso para problemas UCO
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>3.2 Algoritmos de descenso y búsqueda de línea en Unconstrained Convex Optimization (UCO)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplos-de-problemas-de-optimizacion-small-scale">
   Ejemplos de problemas de optimización
   <em>
    small scale
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo">
     Ejemplo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f-o">
     ¿Por qué fue un poco complicado determinar el conjunto de mínimos de
     <span class="math notranslate nohighlight">
      \(f_o\)
     </span>
     ?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-importante">
     Ejemplo importante
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodos-de-descenso">
   Métodos de descenso
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-de-funcion-objetivo-convexa">
     Ejemplo de función objetivo convexa
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#condicion-para-que-un-paso-o-direccion-de-busqueda-sea-de-descenso">
     Condición para que un paso o dirección de búsqueda sea de descenso
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplos-de-direcciones-de-descenso">
     Ejemplos de direcciones de descenso
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#continuando-con-el-ejemplo-anterior">
     Continuando con el ejemplo anterior
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resolviendo-el-problema-con-cvxpy">
     Resolviendo el problema con
     <em>
      CVXPY
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tamano-o-longitud-de-paso">
   Tamaño o longitud de paso
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Continuando con el ejemplo anterior
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#por-que-funciona-lo-anterior">
     ¿Por qué funciona lo anterior?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-de-busqueda-de-linea-por-backtracking">
   Método de búsqueda de línea por
   <em>
    backtracking
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#descenso-suficiente">
     Descenso suficiente
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algoritmo-busqueda-de-linea-por-backtracking">
     Algoritmo: búsqueda de línea por
     <em>
      backtracking
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#funcion-en-python-para-el-metodo-de-backtracking">
   Función en Python para el método de
   <em>
    backtracking
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algoritmo-metodo-general-de-descenso-para-problemas-uco">
   Algoritmo: método general de descenso para problemas UCO
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="algoritmos-de-descenso-y-busqueda-de-linea-en-unconstrained-convex-optimization-uco">
<span id="adbluco"></span><h1>3.2 Algoritmos de descenso y búsqueda de línea en <em>Unconstrained Convex Optimization</em> (UCO)<a class="headerlink" href="#algoritmos-de-descenso-y-busqueda-de-linea-en-unconstrained-convex-optimization-uco" title="Permalink to this headline">#</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker y <code class="docutils literal notranslate"><span class="pre">&lt;versión</span> <span class="pre">imagen</span> <span class="pre">de</span> <span class="pre">docker&gt;</span></code> por la versión más actualizada que se presenta en la documentación.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion:&lt;versión</span> <span class="pre">imagen</span> <span class="pre">de</span> <span class="pre">docker&gt;</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion:&lt;versión</span> <span class="pre">imagen</span> <span class="pre">de</span> <span class="pre">docker&gt;</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion">liga</a>.</p>
</div>
<hr class="docutils" />
<p>Nota generada a partir de <a class="reference external" href="https://drive.google.com/file/d/16-_PvWNaO0Zc9x04-SRsxCRdn5fxebf2/view">liga</a>.</p>
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota la comunidad lectora:</p>
<ul class="simple">
<li><p>Comprenderá el uso de la información de primer y segundo orden para resolver problemas <em>small scale</em> de minimización de funciones convexas mediante los algoritmos general de descenso y de búsqueda de línea por <em>backtracking</em>.</p></li>
<li><p>Aprenderá la importancia y relación con ecuaciones no lineales al resolver los problemas que involucran aproximar mínimos locales de funciones.</p></li>
</ul>
</div>
<p>En esta nota consideramos problemas de optimización <em>small scale</em> <strong>sin restricciones</strong>. Aunque el término <em>small scale</em> es ambiguo pues depende la máquina en la que se realice el cómputo e involucra el número de variables o parámetros y cantidad de almacenamiento para datos, tomamos como <em>small scale</em> aquel problema de optimización sin restricciones en el que se tiene un número de variables del orden menor o igual a <span class="math notranslate nohighlight">\(10^3\)</span>.</p>
<p>Los problemas de optimización sin restricciones, <em>Unconstrained Optimization</em> (UO), son de la forma:</p>
<div class="math notranslate nohighlight">
\[\min f_o(x)\]</div>
<p>con <span class="math notranslate nohighlight">\(f_o:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> función objetivo.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si la función objetivo es convexa se le nombra problema de optimización convexa sin restricciones,<em>Unconstrained Convex Optimization</em> (UCO).</p>
</div>
<section id="ejemplos-de-problemas-de-optimizacion-small-scale">
<h2>Ejemplos de problemas de optimización <em>small scale</em><a class="headerlink" href="#ejemplos-de-problemas-de-optimizacion-small-scale" title="Permalink to this headline">#</a></h2>
<p>En optimización la búsqueda del (o los) <strong>óptimo(s)</strong> involucran el cálculo de información de primer o segundo orden, ver <a class="reference internal" href="../../1.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#fcd"><span class="std std-ref">Definición de función, continuidad y derivada</span></a>, de la función <span class="math notranslate nohighlight">\(f_o\)</span> de acuerdo a lo revisado en los <a class="reference internal" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#resut"><span class="std std-ref">resultados útiles</span></a>. Tal información para problemas <em>small scale</em> es calculada utilizando todos los datos en un enfoque por <em>batch</em> o lote.</p>
<section id="ejemplo">
<h3>Ejemplo<a class="headerlink" href="#ejemplo" title="Permalink to this headline">#</a></h3>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^2} x_1^4+2x_1^2x_2+x_2^2\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">from</span> <span class="nn">sympy.tensor.array</span> <span class="kn">import</span> <span class="n">derive_by_array</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">from</span> <span class="nn">pytest</span> <span class="kn">import</span> <span class="n">approx</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Los candidatos a ser mínimos los encontramos al calcular el gradiente de <span class="math notranslate nohighlight">\(f_o\)</span> que podemos calcular con <em>SymPy</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fo_sympy</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="o">+</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">fo_sympy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4       2        2
x₁  + 2⋅x₁ ⋅x₂ + x₂ 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">fo_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⎡    3                2       ⎤
⎣4⋅x₁  + 4⋅x₁⋅x₂  2⋅x₁  + 2⋅x₂⎦
</pre></div>
</div>
</div>
</div>
<p>y plantear:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla f_o(x) = 
\left [
\begin{array}{c}
4x_1^3+4x_1x_2\\
2x_1^2+2x_2
\end{array}
\right ]=0
\end{split}\]</div>
<p>la cual es una ecuación de dos variables y dos incógnitas <strong>no lineal</strong>. Resolviendo para <span class="math notranslate nohighlight">\(x_2\)</span> se obtiene la relación: <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>. Entonces todos los puntos con coordenadas <span class="math notranslate nohighlight">\(x = (x_1, x_2)\)</span> que satisfacen tal relación cumplen <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span>. ¿Todos serán mínimos locales?</p>
<p><strong>Gráfica de la superficie <span class="math notranslate nohighlight">\(f_o\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fo_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1_np</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x2_np</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">z_np</span> <span class="o">=</span> <span class="n">fo_numpy</span><span class="p">([</span><span class="n">x1_np</span><span class="p">,</span> <span class="n">x2_np</span><span class="p">])</span>
<span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1_np</span><span class="p">,</span> <span class="n">x2_np</span><span class="p">,</span> <span class="n">z_np</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 0, 0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Add an axes</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span> <span class="n">x2_plot</span><span class="p">,</span> <span class="n">z_plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$f_o(x) = x_1^4+2x_1^2x_2+x_2^2$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_98/2605078092.py:4: MatplotlibDeprecationWarning: Calling gca() with keyword arguments was deprecated in Matplotlib 3.4. Starting two minor releases later, gca() will take no keyword arguments. The gca() function should only be used to get the current axes, or if no axes exist, create new axes with default keyword arguments. To create a new axes with non-default arguments, use plt.axes() or plt.subplot().
  ax = fig.gca(projection=&#39;3d&#39;)
</pre></div>
</div>
<img alt="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_29_1.png" src="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_29_1.png" />
</div>
</div>
<p><strong>Gráfica de las curvas de nivel de <span class="math notranslate nohighlight">\(f_o\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span><span class="p">,</span><span class="n">z_plot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Curvas de nivel de $f_o$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_32_0.png" src="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_32_0.png" />
</div>
</div>
<p>Resolvamos con <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fsolve.html#scipy.optimize.fsolve">scipy.optimize.fsolve</a> la ecuación no lineal <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eqn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="o">=</span><span class="n">x</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Elegimos diferentes puntos iniciales.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root1</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root2</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root3</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dic_roots</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;root1&quot;</span><span class="p">:</span> <span class="n">root1</span><span class="p">,</span>
             <span class="s2">&quot;root2&quot;</span><span class="p">:</span> <span class="n">root2</span><span class="p">,</span>
             <span class="s2">&quot;root3&quot;</span><span class="p">:</span> <span class="n">root3</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Obsérvese que los puntos <code class="docutils literal notranslate"><span class="pre">root1</span></code>, <code class="docutils literal notranslate"><span class="pre">root2</span></code>, <code class="docutils literal notranslate"><span class="pre">root3</span></code> satisfacen la relación <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic_roots</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   root1  root2  root3
0    1.0   -1.0    2.0
1   -1.0   -1.0   -4.0
</pre></div>
</div>
</div>
</div>
<p>Al evaluar el gradiente en cada punto obtenemos cero (o cercano a cero):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf_eval</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                       <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span> <span class="k">for</span> <span class="n">partial_derivative</span> <span class="ow">in</span> <span class="n">gf</span><span class="p">],</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;root1&quot;</span><span class="p">:</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">root1</span><span class="p">),</span>
       <span class="s2">&quot;root2&quot;</span><span class="p">:</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">root2</span><span class="p">),</span>
       <span class="s2">&quot;root3&quot;</span><span class="p">:</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">root3</span><span class="p">)}</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los puntos <code class="docutils literal notranslate"><span class="pre">root1</span></code>, <code class="docutils literal notranslate"><span class="pre">root2</span></code> y <code class="docutils literal notranslate"><span class="pre">root3</span></code> resuelven la ecuación no lineal <span class="math notranslate nohighlight">\(\nabla f(x) = 0\)</span> .</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   root1  root2  root3
0    0.0    0.0    0.0
1    0.0   -0.0    0.0
</pre></div>
</div>
</div>
</div>
<p><strong>¿Cómo podemos identificar si son mínimos? …</strong> usamos la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">gf</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⎡     2             ⎤
⎢12⋅x₁  + 4⋅x₂  4⋅x₁⎥
⎢                   ⎥
⎣    4⋅x₁        2  ⎦
</pre></div>
</div>
</div>
</div>
<p>y revisamos eigenvalores de la Hessiana evaluada en los puntos <code class="docutils literal notranslate"><span class="pre">root1</span></code>, <code class="docutils literal notranslate"><span class="pre">root2</span></code>, <code class="docutils literal notranslate"><span class="pre">root3</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_eval</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">second_partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                              <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]})</span> <span class="k">for</span> <span class="n">second_partial_derivative</span> <span class="ow">in</span> <span class="n">Hf</span><span class="p">],</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_root1</span> <span class="o">=</span> <span class="n">Hf_eval</span><span class="p">(</span><span class="n">root1</span><span class="p">)</span>
<span class="n">Hf_root2</span> <span class="o">=</span> <span class="n">Hf_eval</span><span class="p">(</span><span class="n">root2</span><span class="p">)</span>
<span class="n">Hf_root3</span> <span class="o">=</span> <span class="n">Hf_eval</span><span class="p">(</span><span class="n">root3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>La Hessiana en <code class="docutils literal notranslate"><span class="pre">root1</span></code> es semidefinida positiva por lo que no podemos concluir que sea mínimo local de <span class="math notranslate nohighlight">\(f_o\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_root1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[10.  0.]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>La Hessiana en <code class="docutils literal notranslate"><span class="pre">root2</span></code> es semidefinida positiva por lo que no podemos concluir que sea mínimo local de <span class="math notranslate nohighlight">\(f_o\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_root2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[10. -0.]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>La Hessiana en <code class="docutils literal notranslate"><span class="pre">root3</span></code> es semidefinida positiva por lo que no podemos concluir que sea mínimo local de <span class="math notranslate nohighlight">\(f_o\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_root3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[34.  0.]
</pre></div>
</div>
</div>
</div>
<p>Tenemos un criterio para <span class="math notranslate nohighlight">\(2\)</span> dimensiones:</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Sea <span class="math notranslate nohighlight">\(f \in \mathcal{C}^2(\text{intdom}f)\)</span>, <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x))\)</span> determinante de la Hessiana y <span class="math notranslate nohighlight">\(x \in \mathbb{R}^2\)</span> un punto crítico o estacionario de <span class="math notranslate nohighlight">\(f\)</span>:</p>
<ul class="simple">
<li><p>Si <span class="math notranslate nohighlight">\(\frac{\partial^2f(x)}{\partial x_1^2} &lt; 0\)</span> y <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) &gt;0\)</span> entonces <span class="math notranslate nohighlight">\(f\)</span> tiene un <strong>máximo local</strong> en <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\frac{\partial^2f(x)}{\partial x_1^2} &gt; 0\)</span> y <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) &gt;0\)</span> entonces <span class="math notranslate nohighlight">\(f\)</span> tiene un <strong>mínimo local</strong> en <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) &lt; 0\)</span> entonces <span class="math notranslate nohighlight">\(f\)</span> tiene un <strong>punto silla o <a class="reference external" href="https://en.wikipedia.org/wiki/Saddle_point"><em>saddle point</em></a></strong> en <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(\det(\nabla^2 f(x)) = 0\)</span> no podemos concluir si <span class="math notranslate nohighlight">\(x\)</span> es extremo.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>Al determinante de la Hessiana de <span class="math notranslate nohighlight">\(f\)</span> se le nombra <strong>Hessiano</strong> de <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>Lo anterior es un caso particular de los resultados descritos en <a class="reference internal" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#spcriticos"><span class="std std-ref">sobre puntos críticos</span></a>.</p></li>
</ul>
</div>
<p>En el ejemplo el Hessiano es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Hf</span><span class="p">)</span><span class="o">.</span><span class="n">det</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2       
8⋅x₁  + 8⋅x₂
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los tres puntos <code class="docutils literal notranslate"><span class="pre">root1</span></code>, <code class="docutils literal notranslate"><span class="pre">root2</span></code> y <code class="docutils literal notranslate"><span class="pre">root3</span></code> satisfacen <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>.</p>
</aside>
<p>El cual se anula justo en los puntos que cumplen: <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span></p>
<p><span class="math notranslate nohighlight">\(8x_1^2 + 8x_2 = 8 x_1^2 + 8(-x_1^2) = 0\)</span></p>
<p>por lo que no podemos concluir…</p>
<p>Usemos una función de <em>SciPy</em> <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin.html">scipy.optimize.fmin</a></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Elegimos un punto inicial.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_fmin</span> <span class="o">=</span> <span class="n">fmin</span><span class="p">(</span><span class="n">fo_numpy</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.000000
         Iterations: 56
         Function evaluations: 110
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>El punto <code class="docutils literal notranslate"><span class="pre">res_fmin</span></code> satisface <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span> y la relación <span class="math notranslate nohighlight">\(x_2 = -x_1^2\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res_fmin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.063 -0.004]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">res_fmin</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.  0.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_fmin</span> <span class="o">=</span> <span class="n">Hf_eval</span><span class="p">(</span><span class="n">res_fmin</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>La Hessiana en <code class="docutils literal notranslate"><span class="pre">res_fmin</span></code> es semidefinida positiva por lo que no podemos concluir que sea mínimo local de <span class="math notranslate nohighlight">\(f_o\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Hf_fmin</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.    2.032]
</pre></div>
</div>
</div>
</div>
<p>Grafiquemos los puntos que cumplen <span class="math notranslate nohighlight">\(x_2=-x_1^2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">point1</span> <span class="o">=</span> <span class="p">(</span><span class="n">root1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">root1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fo_numpy</span><span class="p">(</span><span class="n">root1</span><span class="p">))</span>
<span class="n">point2</span> <span class="o">=</span> <span class="p">(</span><span class="n">root2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">root2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fo_numpy</span><span class="p">(</span><span class="n">root2</span><span class="p">))</span>
<span class="n">point3</span> <span class="o">=</span> <span class="p">(</span><span class="n">root3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">root3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fo_numpy</span><span class="p">(</span><span class="n">root3</span><span class="p">))</span>
<span class="c1">#another point:</span>
<span class="n">point4</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Add an axes</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span> <span class="n">x2_plot</span><span class="p">,</span> <span class="n">z_plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point3</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">point4</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point4</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point4</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1_plot2</span><span class="p">,</span> <span class="o">-</span><span class="n">x1_plot2</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$f_o(x) = x_1^4+2x_1^2x_2+x_2^2$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_98/1979884310.py:4: MatplotlibDeprecationWarning: Calling gca() with keyword arguments was deprecated in Matplotlib 3.4. Starting two minor releases later, gca() will take no keyword arguments. The gca() function should only be used to get the current axes, or if no axes exist, create new axes with default keyword arguments. To create a new axes with non-default arguments, use plt.axes() or plt.subplot().
  ax = fig.gca(projection=&#39;3d&#39;)
</pre></div>
</div>
<img alt="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_81_1.png" src="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_81_1.png" />
</div>
</div>
<p>Evaluemos en un rango más amplio la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span> y realicemos una gráfica</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1_plot</span><span class="p">,</span><span class="n">x2_plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">z_plot</span> <span class="o">=</span> <span class="n">x1_plot</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1_plot</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x2_plot</span> <span class="o">+</span> <span class="n">x2_plot</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># Add an axes</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x1_plot</span><span class="p">,</span> <span class="n">x2_plot</span><span class="p">,</span> <span class="n">z_plot</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$f_o(x) = x_1^4+2x_1^2x_2+x_2^2$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_98/125119981.py:4: MatplotlibDeprecationWarning: Calling gca() with keyword arguments was deprecated in Matplotlib 3.4. Starting two minor releases later, gca() will take no keyword arguments. The gca() function should only be used to get the current axes, or if no axes exist, create new axes with default keyword arguments. To create a new axes with non-default arguments, use plt.axes() or plt.subplot().
  ax = fig.gca(projection=&#39;3d&#39;)
</pre></div>
</div>
<img alt="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_84_1.png" src="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_84_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">z_plot</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p><strong>El mínimo valor de <span class="math notranslate nohighlight">\(f_o\)</span> es <span class="math notranslate nohighlight">\(0\)</span> por lo que tenemos un conjunto de mínimos dados por la curva <span class="math notranslate nohighlight">\(x_2=-x_1^2\)</span>.</strong></p>
</section>
<section id="por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f-o">
<h3>¿Por qué fue un poco complicado determinar el conjunto de mínimos de <span class="math notranslate nohighlight">\(f_o\)</span>?<a class="headerlink" href="#por-que-fue-un-poco-complicado-determinar-el-conjunto-de-minimos-de-f-o" title="Permalink to this headline">#</a></h3>
<p><strong><span class="math notranslate nohighlight">\(f_o(x)=x_1^4+2x_1^2x_2+x_2^2\)</span> no es una función convexa en su <span class="math notranslate nohighlight">\(\text{dom}f_o\)</span></strong>, <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>, esto es, no satisface la desigualdad:</p>
<div class="math notranslate nohighlight">
\[f_o(\theta x + (1-\theta) y) \leq \theta f_o(x) + (1-\theta)f_o(y)\]</div>
<p><span class="math notranslate nohighlight">\(\forall x,y\)</span> en su dominio y <span class="math notranslate nohighlight">\(\forall \theta \in [0,1]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pointx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">pointy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">point_convex_combination</span> <span class="o">=</span> <span class="n">theta</span><span class="o">*</span><span class="n">pointx</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">pointy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fo_numpy</span><span class="p">(</span><span class="n">point_convex_combination</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.25
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se tiene <span class="math notranslate nohighlight">\(f(\theta x + (1-\theta)y) &gt; \theta f(x) + (1-\theta)f(y)\)</span> con la elección <span class="math notranslate nohighlight">\(\theta=0.5\)</span>, <span class="math notranslate nohighlight">\(x=[-0.5, -1.5]^T\)</span>, <span class="math notranslate nohighlight">\(y=[0.5, -1.5]^T\)</span> lo que indica que <span class="math notranslate nohighlight">\(f\)</span> no es convexa sino cóncava para esta elección de puntos <span class="math notranslate nohighlight">\(x,y\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">theta</span><span class="o">*</span><span class="n">fo_numpy</span><span class="p">(</span><span class="n">pointx</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">fo_numpy</span><span class="p">(</span><span class="n">pointy</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5625
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Recordar que si <span class="math notranslate nohighlight">\(f_o\)</span> es una función convexa, el gradiente de <span class="math notranslate nohighlight">\(f_o\)</span> nos ayuda a determinar si un punto es un mínimo local de forma necesaria y suficiente.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Realizar un análisis similar al anterior para la función <span class="math notranslate nohighlight">\(f_o(x) = x_2^4+2x_2^2x_1^2+x_1^2\)</span>.</p>
</div>
</section>
<section id="ejemplo-importante">
<h3>Ejemplo importante<a class="headerlink" href="#ejemplo-importante" title="Permalink to this headline">#</a></h3>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^2} \frac{1}{2}x^TPx+q^Tx+r\]</div>
<p>donde: <span class="math notranslate nohighlight">\(P=\left [\begin{array}{cc} 5 &amp; 4\\ 4 &amp; 5 \end{array} \right ]\)</span>, <span class="math notranslate nohighlight">\(q=\left [\begin{array}{c} -1\\ 1 \end{array} \right]\)</span>, <span class="math notranslate nohighlight">\(r=3\)</span>.</p>
<p>Haciendo las multiplicaciones de matriz-vector y productos punto</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fo_sympy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">q</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">fo_sympy</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      2                          2         
2.5⋅x₁  + 4.0⋅x₁⋅x₂ - x₁ + 2.5⋅x₂  + x₂ + 3
</pre></div>
</div>
</div>
</div>
<p>se <strong>reescribe</strong> el problema de optimización como:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^2} \frac{5}{2}x_1^2 + \frac{5}{2}x_2^2+4x_1x_2 -x_1 + x_2+3\]</div>
<p>La función objetivo es una <strong>función estrictamente convexa</strong> en <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> (de hecho <strong>fuertemente convexa</strong>) pues:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los eigenvalores de <span class="math notranslate nohighlight">\(P\)</span> son <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(9\)</span> de multiplicidad simple cada uno.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: 1, 9: 1}
</pre></div>
</div>
</div>
</div>
<p>y la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">derive_by_array</span><span class="p">(</span><span class="n">fo_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)),</span>
                             <span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">))</span>
             <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⎡5.0  4.0⎤
⎢        ⎥
⎣4.0  5.0⎦
</pre></div>
</div>
</div>
</div>
<p>El gradiente de <span class="math notranslate nohighlight">\(f_o\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">fo_sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⎡5.0⋅x₁ + 4.0⋅x₂ - 1⎤
⎢                   ⎥
⎣4.0⋅x₁ + 5.0⋅x₂ + 1⎦
</pre></div>
</div>
</div>
</div>
<p>El mínimo debe satisfacer la ecuación <strong>lineal</strong> con dos variables y dos ecuaciones</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f_o(x) = Px +q =\left [ \begin{array}{cc}
5 &amp; 4\\
4 &amp; 5
\end{array}
\right ]
\left [ \begin{array}{c}
x_1\\
x_2
\end{array}
\right ]
+ \left [ \begin{array}{c}
-1\\
1
\end{array}
\right ]=
\left [ \begin{array}{cc}
5x_1+4x_2-1\\
4x_1+5x_2+1
\end{array}
\right ]
=0
\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>En algunos casos especiales es posible resolver la ecuación no lineal <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span> para <span class="math notranslate nohighlight">\(x\)</span> de forma analítica o cerrada. Este es el caso de este ejemplo cuya solución está dada por <span class="math notranslate nohighlight">\(x^* = -P^{-1}q\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="o">-</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 1. -1.]
</pre></div>
</div>
</div>
</div>
<p>El problema anterior también lo podemos resolver con <a class="reference external" href="https://github.com/cvxgrp/cvxpy">cvxpy</a> pues es un <strong>problema convexo</strong>.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Definición de variables y función objetivo: <span class="math notranslate nohighlight">\(\frac{1}{2}x^TPx+q^Tx+r\)</span></p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#number of variables</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c1">#optimization variable</span>
<span class="n">fo_cvxpy</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="o">.</span><span class="n">quad_form</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span> <span class="o">+</span> <span class="n">q</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span> <span class="o">+</span> <span class="n">r</span><span class="c1">#objective function</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt_objective</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">fo_cvxpy</span><span class="p">)</span> <span class="c1">#optimization objective</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">opt_objective</span><span class="p">)</span> <span class="c1">#optimization problem</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;status:&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal value&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal var&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>status: optimal
optimal value 2.0
optimal var [ 1. -1.]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>El paquete cvxpy requiere que se especifique el problema de optimización a resolver siguiendo reglas establecidas en <a class="reference external" href="https://dcp.stanford.edu/">Disciplined Convex Programming</a>. En el ejemplo anterior resulta en un error si se ejecutan las líneas siguientes:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">fo</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">+</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="mi">3</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">fo</span><span class="p">)</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>La última línea produce</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Problem</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">follow</span> <span class="n">DCP</span> <span class="n">rules</span><span class="o">.</span> <span class="n">Specifically</span><span class="p">:</span> <span class="n">The</span> <span class="n">objective</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">DCP</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>En la liga de <a class="reference external" href="https://www.cvxpy.org/examples/index.html">ejemplos</a> hay muchos problemas típicos en optimización convexa y en <a class="reference external" href="https://www.cvxpy.org/tutorial/functions/index.html">Atomic Functions</a> ejemplos de funciones atómicas que pueden aplicarse a expresiones de <em>CVXPY</em>.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Utilizando las herramientas (teóricas y prácticas) del ejemplo anterior, resolver el problema de optimización:</p>
<div class="math notranslate nohighlight">
\[\min_{x \in \mathbb{R}^2} ||Ax-b||_2^2\]</div>
<p>con <span class="math notranslate nohighlight">\(A=\left [ \begin{array}{ccc} 1 &amp; 6 &amp; 2.5\\ 1 &amp; 2 &amp; 8 \\ 1 &amp; 10 &amp; -1\\ 1 &amp; -9 &amp; 3\\ 1 &amp; -1 &amp; 2 \end{array} \right ]\)</span>, <span class="math notranslate nohighlight">\(b=\left [ \begin{array}{c} -1 \\ 0 \\ 2 \\ 3.5 \\ -1.7 \end{array} \right ]\)</span>.</p>
</div>
</section>
</section>
<section id="metodos-de-descenso">
<h2>Métodos de descenso<a class="headerlink" href="#metodos-de-descenso" title="Permalink to this headline">#</a></h2>
<p>Los ejemplos anteriores mostraron la importancia de la información de primer y segundo orden de la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span> y las ecuaciones no lineales para resolver el problema de optimización. El primer ejemplo utilizó las funciones <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fsolve.html#scipy.optimize.fsolve">scipy.optimize.fsolve</a> y <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin.html">scipy.optimize.fmin</a> para este propósito. Tales funciones utilizan métodos iterativos para resolver ecuaciones no lineales y aproximar un mínimo local respectivamente en un esquema que para el caso de minimización satisface:</p>
<div class="math notranslate nohighlight">
\[f_o(x^{(0)}) &gt; f_o(x^{(1)}) &gt; f_o(x^{(2)}) &gt; \cdots &gt; f_o(x^{(k)}) &gt; \cdots\]</div>
<p>con <span class="math notranslate nohighlight">\(x^{(0)}\)</span> punto inicial.</p>
<p>Los métodos que utilizan esquemas iterativos para calcular una <strong>secuencia de minimización</strong> de puntos <span class="math notranslate nohighlight">\(x^{(0)}, x^{(1)}, \dots \in \text{dom}f_o\)</span> con la característica <span class="math notranslate nohighlight">\(f_o(x^{(k)}) \rightarrow p^*\)</span> si <span class="math notranslate nohighlight">\(k \rightarrow \infty\)</span> se conocen con el nombre de <strong>métodos de descenso</strong>.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Un método de descenso es aquel que genera la secuencia de minimización <span class="math notranslate nohighlight">\(x^{(0)}, x^{(1)}, \dots \in \text{dom}f_o\)</span> la cual cumple con la desigualdad: <span class="math notranslate nohighlight">\(f_o(x^{(k+1)}) &lt; f_o(x^{(k)})\)</span> excepto para <span class="math notranslate nohighlight">\(x^{(k)}\)</span> óptimo y <span class="math notranslate nohighlight">\(f_o(x^{(k)}) \rightarrow p^*\)</span> si <span class="math notranslate nohighlight">\(k \rightarrow \infty\)</span>.</p>
</div>
<p>La secuencia de minimización en un método de descenso se genera con la expresión:</p>
<div class="math notranslate nohighlight">
\[x^{(k+1)} = x^{(k)} + \Delta x\]</div>
<p>donde: <span class="math notranslate nohighlight">\(\Delta x\)</span> es dirección de búsqueda que es de descenso.</p>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>La definición de una dirección de descenso anterior aplica para funciones en general, no es necesario que <span class="math notranslate nohighlight">\(f_o\)</span> sea convexa.</p></li>
<li><p>En la práctica la secuencia de minimización involucra calcular un tamaño o longitud de paso que ayuda a la convergencia del método. Se tienen diferentes metodologías para su cálculo y más adelante se describe una de ellas.</p></li>
</ul>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que si <span class="math notranslate nohighlight">\(f_o\)</span> es fuertemente convexa en el conjunto <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> entonces <span class="math notranslate nohighlight">\(\nabla^2 f_o (x) \in \mathbb{S}^n_{++}\)</span> y <span class="math notranslate nohighlight">\(\text{cond}(\nabla ^2 f_o(x))\)</span> está acotado por arriba por una constante para <span class="math notranslate nohighlight">\(x \in \mathcal{S}\)</span>.</p>
</aside>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Asumiendo que la función <span class="math notranslate nohighlight">\(f_o\)</span> es convexa, típicamente se asume lo siguiente para tener métodos iterativos confiables y exactos:</p>
<ul class="simple">
<li><p>Los puntos iniciales <span class="math notranslate nohighlight">\(x^{(0)}\)</span> están en <span class="math notranslate nohighlight">\(\text{dom}f_o\)</span>.</p></li>
<li><p>Que el conjunto <span class="math notranslate nohighlight">\(f_o(x^{(0)})\)</span>-subnivel sea cerrado pues así se garantiza que la secuencia de minimización está en el conjunto <span class="math notranslate nohighlight">\(f_o(x^{(0)})\)</span>-subnivel para todas las iteraciones.</p></li>
<li><p><span class="math notranslate nohighlight">\(f_o\)</span> fuertemente convexa en el conjunto <span class="math notranslate nohighlight">\(f_o(x^{(0)})\)</span>-subnivel para tener propiedades dadas en los <a class="reference internal" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#resffuertcon"><span class="std std-ref">resultados que son posibles probar para funciones fuertemente convexas</span></a>.</p></li>
</ul>
</div>
<p>En lo siguiente se asume que <span class="math notranslate nohighlight">\(f_o\)</span> cumple <span class="math notranslate nohighlight">\(f_o \in \mathcal{C}^2(\text{dom}f_o)\)</span> y es convexa en un conjunto convexo y cerrado que contiene a <span class="math notranslate nohighlight">\(x^*\)</span>. Ver <a class="reference internal" href="../../1.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#cacci"><span class="std std-ref">conjunto abierto, cerrado, cerradura e interior</span></a> para definición de conjunto cerrado.</p>
<section id="ejemplo-de-funcion-objetivo-convexa">
<h3>Ejemplo de función objetivo convexa<a class="headerlink" href="#ejemplo-de-funcion-objetivo-convexa" title="Permalink to this headline">#</a></h3>
<p>Encontrar el mínimo del siguiente problema con un <strong>método iterativo</strong>.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^4} (x_1-2)^2+(2-x_2)^2+x_3^2+x_4^4\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x1, x2, x3, x4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fo_sympy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x4</span><span class="o">**</span><span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">fo_sympy</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⎡                              3⎤
⎣2⋅x₁ - 4  2⋅x₂ - 4  2⋅x₃  4⋅x₄ ⎦
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf</span> <span class="o">=</span> <span class="n">derive_by_array</span><span class="p">(</span><span class="n">gf</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⎡2  0  0    0   ⎤
⎢               ⎥
⎢0  2  0    0   ⎥
⎢               ⎥
⎢0  0  2    0   ⎥
⎢               ⎥
⎢              2⎥
⎣0  0  0  12⋅x₄ ⎦
</pre></div>
</div>
</div>
</div>
<p>Como <span class="math notranslate nohighlight">\(f_o\)</span> es una función convexa (de hecho <strong>estrictamente convexa</strong>) en su dominio <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>, se tiene que su óptimo se obtiene igualando y resolviendo la <strong>ecuación no lineal</strong> <span class="math notranslate nohighlight">\(\nabla f_o(x) = 0\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f_o(x) = 
\left[ \begin{array}{c}
2x_1-4 \\
2x_2-4\\
2x_3\\
4x_4^3
\end{array}
\right]
= 0
\end{split}\]</div>
<p>El óptimo <span class="math notranslate nohighlight">\(x^* \in \mathbb{R}^4\)</span> está dado por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x^*=
\left[ \begin{array}{c}
2\\
2\\
0\\
0
\end{array}
\right]
\end{split}\]</div>
<p><strong>¿Cómo encontramos numéricamente el óptimo con un método iterativo?</strong></p>
</section>
<section id="condicion-para-que-un-paso-o-direccion-de-busqueda-sea-de-descenso">
<h3>Condición para que un paso o dirección de búsqueda sea de descenso<a class="headerlink" href="#condicion-para-que-un-paso-o-direccion-de-busqueda-sea-de-descenso" title="Permalink to this headline">#</a></h3>
<p>La idea de los métodos de optimización es calcular direcciones <span class="math notranslate nohighlight">\(\Delta x\)</span> de búsqueda que sean de descenso, esto es, que al movernos de un punto a otro en tal dirección, el valor de <span class="math notranslate nohighlight">\(f_o\)</span> decrece. Existen muchas direcciones de descenso (de hecho infinitas) una que se muestra en el dibujo siguiente es la dirección de descenso de Newton <span class="math notranslate nohighlight">\(\Delta x_{nt}\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/25bmebx645howjw/direccion_de_descenso_de_Newton_1d.png?dl=0" heigth="600" width="600"><p>En el dibujo <span class="math notranslate nohighlight">\(f = f_o\)</span> y <span class="math notranslate nohighlight">\(\hat{f}\)</span> es un <strong>modelo cuadrático</strong>. Del punto <span class="math notranslate nohighlight">\((x,f(x))\)</span> nos debemos mover al punto <span class="math notranslate nohighlight">\((x+\Delta x_{nt}, f(x + \Delta x_{nt}))\)</span> para llegar al óptimo. En tal dirección <span class="math notranslate nohighlight">\(f\)</span> decrece: <span class="math notranslate nohighlight">\(f(x+\Delta x_{nt}) &lt; f(x)\)</span> y obsérvese que <span class="math notranslate nohighlight">\(\Delta x_{nt}\)</span> es mínimo de <span class="math notranslate nohighlight">\(\hat{f}\)</span>.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference internal" href="../../1.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html#teotaylornvariables"><span class="std std-ref">teorema de Taylor para una función de varias variables</span></a></p>
</aside>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El modelo cuadrático del dibujo anterior está dado por la aproximación de segundo orden a la función <span class="math notranslate nohighlight">\(f_o\)</span> por el teorema de Taylor con centro en <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="math notranslate nohighlight">
\[m(x + v) = \hat{f}_o(x + v) = f_o(x) + \nabla f_o(x)^T v + \frac{1}{2} v^T \nabla^2f_o(x)v\]</div>
<p>con único mínimo si <span class="math notranslate nohighlight">\(\nabla ^2 f_o(x) \in \mathbb{S}^n_{++}\)</span> dado por <span class="math notranslate nohighlight">\(v^* = \Delta x_{nt}\)</span> y <span class="math notranslate nohighlight">\(\Delta x_{nt}\)</span> dirección de Newton cuya expresión está más adelante. En cada iteración se construye un modelo cuadrático:</p>
<div class="math notranslate nohighlight">
\[m(x^{(k)} + v) = \hat{f}_o(x^{(k)} + v) = f_o(x^{(k)}) + \nabla f_o(x^{(k)})^T v + \frac{1}{2} v^T \nabla^2f_o(x^{(k)})v\]</div>
</div>
<p>Geométricamente las direcciones de descenso forman un <strong>ángulo agudo</strong> con <span class="math notranslate nohighlight">\(-\nabla f_o(x)\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/eednhn6lj1rag1j/zone_for_descent_directions.png?dl=0" heigth="350" width="350">
<p>En el dibujo <span class="math notranslate nohighlight">\(f = f_o\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Aunque se tienen una cantidad infinita de direcciones de descenso, las direcciones de descenso que típicamente son elegidas no son cercanas a ser ortogonales con el gradiente de <span class="math notranslate nohighlight">\(f_o\)</span>.</p>
</div>
<p>Tenemos una condición para garantizar que una dirección sea de descenso:</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Si el paso o dirección de búsqueda satisface: <span class="math notranslate nohighlight">\(\nabla f_o(x)^T\Delta x &lt; 0\)</span> se le nombra <strong>dirección de descenso</strong>.</p>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que el teorema de Taylor nos ayuda a aproximar a una función de forma <strong>local</strong>.</p>
</aside>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Recuérdese que <span class="math notranslate nohighlight">\(\nabla f_o(x)^T \Delta x\)</span> es una <strong>derivada direccional</strong> de <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x\)</span> en la dirección <span class="math notranslate nohighlight">\(\Delta x\)</span>, ver <a class="reference internal" href="../../1.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#ejrestriccionalinea"><span class="std std-ref">ejemplo función restringida a una línea</span></a>.</p></li>
<li><p>La definición anterior se justifica pues recuérdese que por la aproximación del teorema de Taylor a primer orden se tiene:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f_o(x + \Delta x) \approx f_o(x) + \nabla f_o(x) ^T \Delta x\]</div>
<p>y si <span class="math notranslate nohighlight">\(\Delta x\)</span> es dirección de descenso entonces: <span class="math notranslate nohighlight">\(f_o(x) + \nabla f_o(x) ^T \Delta x &lt; f_o(x)\)</span>.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que si <span class="math notranslate nohighlight">\(x^*\)</span> es mínimo local entonces <span class="math notranslate nohighlight">\(\nabla f_o(x^*) = 0\)</span> (condición necesaria de primer orden) por lo que no existen direcciones de descenso.</p>
</div>
</section>
<section id="ejemplos-de-direcciones-de-descenso">
<h3>Ejemplos de direcciones de descenso<a class="headerlink" href="#ejemplos-de-direcciones-de-descenso" title="Permalink to this headline">#</a></h3>
<aside class="sidebar">
<p class="sidebar-title">La dirección del gradiente…</p>
<p>Una forma de obtener la dirección de Newton es encontrando el mínimo del modelo cuadrático referido anteriormente asumiendo <span class="math notranslate nohighlight">\(\nabla ^2 f_o(x) \in \mathbb{S}^n_{++}\)</span>. La dirección del gradiente se obtiene al resolver el problema de optimización con restricciones siguiente:</p>
<div class="math notranslate nohighlight">
\[\min_{v \in \mathbb{R}^n} \nabla f_o(x)^T v\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:} ||v|| = 1\]</div>
<p>para la norma <span class="math notranslate nohighlight">\(2\)</span>. Se utiliza una restricción del tipo normalización pues la función objetivo involucra un producto punto (derivada direccional) que es dependiente o proporcional a la longitud de <span class="math notranslate nohighlight">\(v\)</span>.</p>
</aside>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta x = - \nabla f_o \left (x^{(k)} \right )\)</span> que da lugar al <strong>método de descenso en gradiente</strong> para <span class="math notranslate nohighlight">\(x^{(k)}\)</span> no óptimo.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta x = - \nabla^2 f_o \left (x^{(k)} \right )^{-1} \nabla f_o\left(x^{(k)} \right)\)</span> que da lugar al <strong>método de descenso por Newton</strong> con <span class="math notranslate nohighlight">\(\nabla^2 f_o \left (x^{(k)} \right ) \in \mathbb{S}^n_{++}\)</span> y <span class="math notranslate nohighlight">\(x^{(k)}\)</span> no óptimo.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta x = - H_k ^{-1} \nabla f_o\left(x^{(k)}\right)\)</span>  con <span class="math notranslate nohighlight">\(H_k\)</span> aproximación a la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span> con <span class="math notranslate nohighlight">\(\nabla^2 f_o \left (x^{(k)} \right ) \in \mathbb{S}^n_{++}\)</span> y <span class="math notranslate nohighlight">\(x^{(k)}\)</span> no óptimo.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>La definición de una dirección de descenso aplica para funciones en general, no es necesario que <span class="math notranslate nohighlight">\(f_o\)</span> sea convexa.</p></li>
<li><p>Para funciones en general, la dirección de Newton es de descenso si la Hessiana es definida positiva y análogamente para las direcciones en las que se utilicen aproximaciones a la Hessiana. Esto asegura que el <strong>modelo cuadrático</strong> tenga un único mínimo y que <span class="math notranslate nohighlight">\(f_o\)</span> decrezca su valor en tal dirección.</p></li>
<li><p>Comúnmente los métodos que utilizan aproximaciones a la Hessiana se conocen con el nombre de <strong>métodos Cuasi-Newton</strong>, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Quasi-Newton_method">Quasi-Newton_method</a>.</p></li>
</ul>
</div>
</section>
<section id="continuando-con-el-ejemplo-anterior">
<h3>Continuando con el ejemplo anterior<a class="headerlink" href="#continuando-con-el-ejemplo-anterior" title="Permalink to this headline">#</a></h3>
<p>Encontrar el mínimo del siguiente problema con un <strong>método iterativo</strong>.</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^4} (x_1-2)^2+(2-x_2)^2+x_3^2+x_4^4\]</div>
<p><strong>Opción descenso en gradiente</strong>: usando la dirección del gradiente de <span class="math notranslate nohighlight">\(f_o\)</span> se tiene:</p>
<div class="math notranslate nohighlight">
\[x^{(k+1)} = x^{(k)} - \nabla f_o(x^{(k)})\]</div>
<p>Tomando <span class="math notranslate nohighlight">\(x^{(0)} = \left [ \begin{array}{c} 5 \\ 5 \\1 \\ 0.1 \\ \end{array} \right ]\)</span> como punto inicial:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Definición de <span class="math notranslate nohighlight">\(f_o\)</span></p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_o_np</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(0)}\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.01
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf_eval</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                       <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                       <span class="s2">&quot;x3&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                       <span class="s2">&quot;x4&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]})</span> <span class="k">for</span> <span class="n">partial_derivative</span> <span class="ow">in</span> <span class="n">gf</span><span class="p">],</span>
                              <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando el gradiente en <span class="math notranslate nohighlight">\(x^{(0)}\)</span>: <span class="math notranslate nohighlight">\(\nabla f_o(x^{(0)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[6.    6.    2.    0.004]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Verificando que es dirección de descenso: <span class="math notranslate nohighlight">\(\nabla f_o \left (x^{(0)} \right )^T \Delta x &lt; 0\)</span> con <span class="math notranslate nohighlight">\(\Delta x = -\nabla f_o \left (x^{(0)} \right )\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-76.000016
</pre></div>
</div>
</div>
</div>
<p><strong>Primera iteración</strong></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esquema iterativo: <span class="math notranslate nohighlight">\(x_1 = x_0 + \Delta x = x_0 - \nabla f_o(x^{(0)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_1</span> <span class="o">=</span> <span class="n">x_0</span> <span class="o">-</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.    -1.    -1.     0.096]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(1)}\)</span> se observa que <span class="math notranslate nohighlight">\(f_o\)</span> decreció muy poco, de hecho <span class="math notranslate nohighlight">\(f_o(x^{(0)}) \approx f_o(x^{(1)})\)</span>.</p>
</aside>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.01
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.009216
</pre></div>
</div>
</div>
</div>
<p>Obsérvese que la aproximación a primer orden por Taylor no es correcta: <span class="math notranslate nohighlight">\(f_o(x_0 + \Delta x) \neq f_o(x_0) + \nabla f_o(x_0)^T \Delta x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span> <span class="o">+</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-56.990016
</pre></div>
</div>
</div>
</div>
<p><strong>Segunda iteración</strong></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando el gradiente en <span class="math notranslate nohighlight">\(x^{(1)}\)</span>: <span class="math notranslate nohighlight">\(\nabla f_o(x^{(1)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-6.    -6.    -2.     0.004]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Verificando que es dirección de descenso: <span class="math notranslate nohighlight">\(\nabla f_o \left (x^{(1)} \right )^T \Delta x &lt; 0\)</span> con <span class="math notranslate nohighlight">\(\Delta x = -\nabla f_o \left (x^{(1)} \right )\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-76.00001252412463
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esquema iterativo: <span class="math notranslate nohighlight">\(x_2 = x_1 + \Delta x = x_1 - \nabla f_o(x^{(1)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_2</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">-</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5.    5.    1.    0.092]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(1)}\)</span> se observa que <span class="math notranslate nohighlight">\(f_o\)</span> decreció muy poco, de hecho <span class="math notranslate nohighlight">\(f_o(x^{(2)}) \approx f_o(x^{(1)})\)</span>.</p>
</aside>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.009216
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.008549046876634
</pre></div>
</div>
</div>
</div>
<p>Obsérvese que la aproximación a primer orden por Taylor no es correcta: <span class="math notranslate nohighlight">\(f_o(x_1 + \Delta x) \neq f_o(x_1) + \nabla f_o(x_1)^T \Delta x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-56.99079652412463
</pre></div>
</div>
</div>
</div>
<p><strong>Tercera iteración</strong></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esquema iterativo: <span class="math notranslate nohighlight">\(x_3 = x_2 + \Delta x = x_2 - \nabla f_o(x^{(2)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_3</span> <span class="o">=</span> <span class="n">x_2</span> <span class="o">-</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Obsérvese que <span class="math notranslate nohighlight">\(x_3 \approx x_1\)</span>.</p>
</aside>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.    -1.    -1.     0.096]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.    -1.    -1.     0.089]
</pre></div>
</div>
</div>
</div>
<p><strong>Cuarta iteración</strong></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esquema iterativo: <span class="math notranslate nohighlight">\(x_4 = x_3 + \Delta x = x_3 - \nabla f_o(x^{(3)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_4</span> <span class="o">=</span> <span class="n">x_3</span> <span class="o">-</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Obsérvese que <span class="math notranslate nohighlight">\(x_4 \approx x_2\)</span>.</p>
</aside>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5.    5.    1.    0.092]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5.    5.    1.    0.086]
</pre></div>
</div>
</div>
</div>
<p>y así nos quedaremos ciclando por muchas iteraciones…</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El método de descenso en gradiente para el ejemplo anterior no convergerá al óptimo <span class="math notranslate nohighlight">\(x^* = \left [ \begin{array}{c} 2 \\ 2 \\0 \\ 0 \\ \end{array} \right ]\)</span></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>¿Converge el método de descenso en gradiente al óptimo para un punto inicial <span class="math notranslate nohighlight">\(x^{(0)} = \left [ \begin{array}{c} 2.5 \\ 2.5 \\0.001 \\ 0.001 \\ \end{array} \right ]\)</span>?</p>
</div>
<p><strong>Opción descenso por dirección de Newton:</strong> usando la dirección de descenso de Newton de <span class="math notranslate nohighlight">\(f_o\)</span> se tiene:</p>
<div class="math notranslate nohighlight">
\[x^{(k+1)} = x^{(k)} - \nabla^2 f_o \left (x^{(k)} \right )^{-1} \nabla f_o\left(x^{(k)} \right)\]</div>
<p>Con</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla ^2 f_o(x) = 
\left [ 
\begin{array}{cccc}
2 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 2 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 12x_4^2
\end{array}
\right ]
\end{split}\]</div>
<p>Tomando <span class="math notranslate nohighlight">\(x^{(0)} = \left [ \begin{array}{c} 5 \\ 5 \\1 \\ 0.1 \\ \end{array} \right ]\)</span> como punto inicial y <strong>no calculando la inversa</strong> de la Hessiana pues en su lugar resolvemos el sistema de ecuaciones lineales <span class="math notranslate nohighlight">\(\nabla ^2 f_o \left ( x^{(k)} \right ) \Delta x = - \nabla f_o \left(x^{(k)}\right )\)</span> resulta</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_eval</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">second_partial_derivative</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="s2">&quot;x1&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                                                              <span class="s2">&quot;x2&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                              <span class="s2">&quot;x3&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                              <span class="s2">&quot;x4&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]})</span> <span class="k">for</span> <span class="n">second_partial_derivative</span> <span class="ow">in</span> <span class="n">Hf</span><span class="p">],</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando la Hessiana en <span class="math notranslate nohighlight">\(x^{(0)}\)</span>: <span class="math notranslate nohighlight">\(\nabla^2f_o(x^{(0)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_sympy_eval</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Hf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⎡2.0  0.0  0.0  0.0 ⎤
⎢                   ⎥
⎢0.0  2.0  0.0  0.0 ⎥
⎢                   ⎥
⎢0.0  0.0  2.0  0.0 ⎥
⎢                   ⎥
⎣0.0  0.0  0.0  0.12⎦
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando el gradiente en <span class="math notranslate nohighlight">\(x^{(0)}\)</span>: <span class="math notranslate nohighlight">\(\nabla f_o(x^{(0)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf_sympy_eval</span> <span class="o">=</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gf_sympy_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[6.    6.    2.    0.004]
</pre></div>
</div>
</div>
</div>
<p>El sistema de <strong>ecuaciones lineales</strong> a resolver es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{cccc}
2 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 2 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0.12
\end{array}
\right ]
\Delta x = 
-\left [
\begin{array}{c}
6 \\
6 \\
2 \\
0.004
\end{array}
\right ]
\end{split}\]</div>
<p>Resolviendo con <em>NumPy</em> el sistema de ecuaciones lineales:</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Aquí convertimos de un objeto de <em>SymPy</em> a un <em>array</em> de <em>NumPy</em> pues si bien podríamos resolver el sistema con <em>SymPy</em> es menos costoso utilizar <em>arrays</em> de <em>NumPy</em>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_np_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">Hf_np_eval</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Aquí convertimos de un objeto de <em>SymPy</em> a un <em>array</em> de <em>NumPy</em> pues si bien podríamos resolver el sistema con <em>SymPy</em> es menos costoso utilizar <em>arrays</em> de <em>NumPy</em>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf_np_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gf_sympy_eval</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf_np_eval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([6.   , 6.   , 2.   , 0.004])
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Resolvemos <span class="math notranslate nohighlight">\(\nabla ^2 f_o \left ( x^{(0)} \right ) \Delta x = - \nabla f_o \left(x^{(0)}\right )\)</span> para obtener <span class="math notranslate nohighlight">\(\Delta x\)</span> dirección de Newton.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_Newton</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="p">,</span> <span class="o">-</span><span class="n">gf_np_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.    -3.    -1.    -0.033]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Verificando que es dirección de descenso: <span class="math notranslate nohighlight">\(\nabla f_o \left (x^{(0)} \right )^T \Delta x &lt; 0\)</span> con <span class="math notranslate nohighlight">\(\Delta x = -\nabla ^2f_o(x^{(0)})^{-1} \nabla f_o(x^{(0)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_np_eval</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-38.00013333333333
</pre></div>
</div>
</div>
</div>
<p><strong>Primera iteración</strong></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esquema iterativo: <span class="math notranslate nohighlight">\(x_1 = x_0 + \Delta x = x_0 - \nabla ^2f_o(x^{(0)})^{-1} \nabla f_o(x^{(0)})\)</span></p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_1</span> <span class="o">=</span> <span class="n">x_0</span> <span class="o">+</span> <span class="n">dir_Newton</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.    2.    0.    0.067]
</pre></div>
</div>
</div>
</div>
<p>Recuérdese que <strong>siempre</strong> es útil monitorear el número de condición de la matriz del sistema de ecuaciones lineales que en este caso es la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(0)}\)</span> para confiabilidad de nuestros cálculos al resolver el sistema de ecuaciones lineales asociado, ver <a class="reference internal" href="../../1.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html#ncm"><span class="std std-ref">Número de condición de una matriz</span></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.666666666666664
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(1)}\)</span> se observa que <span class="math notranslate nohighlight">\(f_o\)</span> sí decrece <span class="math notranslate nohighlight">\(f_o(x^{(1)}) &lt; f_o(x^{(0)})\)</span>.</p>
</aside>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19.01
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.004444444444444446
</pre></div>
</div>
</div>
</div>
<p>Obsérvese que la aproximación a segundo orden por Taylor es cercana: <span class="math notranslate nohighlight">\(f_o(x_0 + \Delta x) \approx f_o(x_0) + \nabla f_o(x_0)^T \Delta x + \frac{1}{2}\Delta x ^T\nabla^2 f_o(x_0) \Delta x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span> <span class="o">+</span> <span class="n">gf_np_eval</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">dir_Newton</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="nd">@dir_Newton</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.009933333333336236
</pre></div>
</div>
</div>
</div>
<p><strong>Segunda iteración</strong></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando la Hessiana en <span class="math notranslate nohighlight">\(x^{(1)}\)</span>: <span class="math notranslate nohighlight">\(\nabla^2f_o(x^{(1)})\)</span>, evaluando el gradiente en <span class="math notranslate nohighlight">\(x^{(1)}\)</span>: <span class="math notranslate nohighlight">\(\nabla f_o(x^{(1)})\)</span> y resolviendo el sistema de ecuaciones <span class="math notranslate nohighlight">\(\nabla ^2 f_o \left ( x^{(1)} \right ) \Delta x = - \nabla f_o \left(x^{(1)}\right )\)</span>.</p>
</aside>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esquema iterativo: <span class="math notranslate nohighlight">\(x_2 =  x_1 + \Delta x = x_1 - \nabla ^2f_o(x^{(1)})^{-1} \nabla f_o(x^{(1)})\)</span></p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_sympy_eval</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Hf_eval</span><span class="p">(</span><span class="n">x_1</span><span class="p">))</span>
<span class="n">gf_sympy_eval</span> <span class="o">=</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
<span class="n">Hf_np_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">gf_np_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gf_sympy_eval</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>
<span class="n">dir_Newton</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="p">,</span> <span class="o">-</span><span class="n">gf_np_eval</span><span class="p">)</span>
<span class="n">x_2</span> <span class="o">=</span> <span class="n">x_1</span> <span class="o">+</span> <span class="n">dir_Newton</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.    2.    0.    0.044]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Verificando que es dirección de descenso: <span class="math notranslate nohighlight">\(\nabla f_o \left (x^{(1)} \right )^T \Delta x &lt; 0\)</span> con <span class="math notranslate nohighlight">\(\Delta x = -\nabla ^2f_o(x^{(1)})^{-1} \nabla f_o(x^{(1)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_np_eval</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.6337448559670797e-05
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(2)}\)</span> se observa que <span class="math notranslate nohighlight">\(f_o\)</span> sí decrece <span class="math notranslate nohighlight">\(f_o(x^{(2)}) &lt; f_o(x^{(1)})\)</span>.</p>
</aside>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.004444444444444446
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0019753086419753096
</pre></div>
</div>
</div>
</div>
<p>Obsérvese que la aproximación a segundo orden por Taylor es cercana: <span class="math notranslate nohighlight">\(f_o(x_1 + \Delta x) \approx f_o(x_1) + \nabla f_o(x_1)^T \Delta x + \frac{1}{2}\Delta x ^T\nabla^2 f_o(x_1) \Delta x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">gf_np_eval</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">dir_Newton</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="nd">@dir_Newton</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.004431275720164611
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Número de condición de la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(1)}\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>37.499999999999986
</pre></div>
</div>
</div>
</div>
<p><strong>Tercera iteración</strong></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando la Hessiana en <span class="math notranslate nohighlight">\(x^{(2)}\)</span>: <span class="math notranslate nohighlight">\(\nabla^2f_o(x^{(2)})\)</span>, evaluando el gradiente en <span class="math notranslate nohighlight">\(x^{(2)}\)</span>: <span class="math notranslate nohighlight">\(\nabla f_o(x^{(2)})\)</span>  y resolviendo el sistema de ecuaciones <span class="math notranslate nohighlight">\(\nabla ^2 f_o \left ( x^{(2)} \right ) \Delta x = - \nabla f_o \left(x^{(2)}\right )\)</span>.</p>
</aside>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esquema iterativo: <span class="math notranslate nohighlight">\(x_3 = x_2 + \Delta x = x_2 - \nabla ^2f_o(x^{(2)})^{-1} \nabla f_o(x^{(2)})\)</span></p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_sympy_eval</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Hf_eval</span><span class="p">(</span><span class="n">x_2</span><span class="p">))</span>
<span class="n">gf_sympy_eval</span> <span class="o">=</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span>
<span class="n">Hf_np_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">gf_np_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gf_sympy_eval</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>
<span class="n">dir_Newton</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="p">,</span> <span class="o">-</span><span class="n">gf_np_eval</span><span class="p">)</span>
<span class="n">x_3</span> <span class="o">=</span> <span class="n">x_2</span> <span class="o">+</span> <span class="n">dir_Newton</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.   2.   0.   0.03]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Verificando que es dirección de descenso: <span class="math notranslate nohighlight">\(\nabla f_o \left (x^{(2)} \right )^T \Delta x &lt; 0\)</span> con <span class="math notranslate nohighlight">\(\Delta x = -\nabla ^2f_o(x^{(2)})^{-1} \nabla f_o(x^{(2)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_np_eval</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-5.202458974749789e-06
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(3)}\)</span> se observa que <span class="math notranslate nohighlight">\(f_o\)</span> sí decrece <span class="math notranslate nohighlight">\(f_o(x^{(3)}) &lt; f_o(x^{(2)})\)</span>.</p>
</aside>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0019753086419753096
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0008779149519890264
</pre></div>
</div>
</div>
</div>
<p>Obsérvese que la aproximación a segundo orden por Taylor es cercana: <span class="math notranslate nohighlight">\(f_o(x_2 + \Delta x) \approx f_o(x_2) + \nabla f_o(x_2)^T \Delta x + \frac{1}{2}\Delta x ^T\nabla^2 f_o(x_2) \Delta x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_2</span><span class="p">)</span> <span class="o">+</span> <span class="n">gf_np_eval</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">dir_Newton</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="nd">@dir_Newton</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0019727074124879346
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Número de condición de la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(2)}\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>84.37499999999997
</pre></div>
</div>
</div>
</div>
<p><strong>Cuarta iteración</strong></p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando la Hessiana en <span class="math notranslate nohighlight">\(x^{(3)}\)</span>: <span class="math notranslate nohighlight">\(\nabla^2f_o(x^{(3)})\)</span>, evaluando el gradiente en <span class="math notranslate nohighlight">\(x^{(3)}\)</span>: <span class="math notranslate nohighlight">\(\nabla f_o(x^{(3)})\)</span>  y resolviendo el sistema de ecuaciones <span class="math notranslate nohighlight">\(\nabla ^2 f_o \left ( x^{(3)} \right ) \Delta x = - \nabla f_o \left(x^{(3)}\right )\)</span>.</p>
</aside>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esquema iterativo: <span class="math notranslate nohighlight">\(x_4 = x_3 + \Delta x = x_3 - \nabla ^2f_o(x^{(3)})^{-1} \nabla f_o(x^{(3)})\)</span></p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_sympy_eval</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Hf_eval</span><span class="p">(</span><span class="n">x_3</span><span class="p">))</span>
<span class="n">gf_sympy_eval</span> <span class="o">=</span> <span class="n">gf_eval</span><span class="p">(</span><span class="n">x_3</span><span class="p">)</span>
<span class="n">Hf_np_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">gf_np_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gf_sympy_eval</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>
<span class="n">dir_Newton</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="p">,</span> <span class="o">-</span><span class="n">gf_np_eval</span><span class="p">)</span>
<span class="n">x_4</span> <span class="o">=</span> <span class="n">x_3</span> <span class="o">+</span> <span class="n">dir_Newton</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.   2.   0.   0.02]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Verificando que es dirección de descenso: <span class="math notranslate nohighlight">\(\nabla f_o \left (x^{(3)} \right )^T \Delta x &lt; 0\)</span> con <span class="math notranslate nohighlight">\(\Delta x = -\nabla ^2f_o(x^{(3)})^{-1} \nabla f_o(x^{(3)})\)</span>.</p>
</aside>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Obsérvese que el gradiente y la dirección de Newton son cercanos a ser ortogonales.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gf_np_eval</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.027646217234526e-06
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(4)}\)</span> se observa que <span class="math notranslate nohighlight">\(f_o\)</span> sí decrece <span class="math notranslate nohighlight">\(f_o(x^{(4)}) &lt; f_o(x^{(3)})\)</span>.</p>
</aside>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0008779149519890264
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.00039018442310623393
</pre></div>
</div>
</div>
</div>
<p>Obsérvese que la aproximación a segundo orden por Taylor es cercana: <span class="math notranslate nohighlight">\(f_o(x_3 + \Delta x) \approx f_o(x_3) + \nabla f_o(x_3)^T \Delta x + \frac{1}{2}\Delta x ^T\nabla^2 f_o(x_3) \Delta x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f_o_np</span><span class="p">(</span><span class="n">x_3</span><span class="p">)</span> <span class="o">+</span> <span class="n">gf_np_eval</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dir_Newton</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">dir_Newton</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="nd">@dir_Newton</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.000877401128880409
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Obsérvese cómo va aumentando el número de condición de la Hessiana conforme nos aproximamos a la solución, en este paso se ha calculado la Hessiana de <span class="math notranslate nohighlight">\(f_o\)</span> en <span class="math notranslate nohighlight">\(x^{(3)}\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">Hf_np_eval</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>189.84374999999991
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_4</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]),</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El método por dirección de Newton sí convergerá al óptimo <span class="math notranslate nohighlight">\(x^* = \left [ \begin{array}{c} 2 \\ 2 \\0 \\ 0 \\ \end{array} \right ]\)</span> pero la convergencia será lenta.</p>
</div>
<p>Si hubiéramos elegido como punto inicial <span class="math notranslate nohighlight">\(x^{(0)} = \left [ \begin{array}{c} 5 \\ 5 \\1 \\ 0 \\ \end{array} \right ]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando la Hessiana en <span class="math notranslate nohighlight">\(x^{(0)}\)</span>: <span class="math notranslate nohighlight">\(\nabla^2f_o(x^{(0)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Hf_sympy_eval</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Hf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⎡2.0  0.0  0.0  0.0⎤
⎢                  ⎥
⎢0.0  2.0  0.0  0.0⎥
⎢                  ⎥
⎢0.0  0.0  2.0  0.0⎥
⎢                  ⎥
⎣0.0  0.0  0.0  0.0⎦
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Evaluando el gradiente en <span class="math notranslate nohighlight">\(x^{(0)}\)</span>: <span class="math notranslate nohighlight">\(\nabla f_o(x^{(0)})\)</span>.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf_sympy_eval</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">))</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">gf_sympy_eval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>⎡6.0⎤
⎢   ⎥
⎢6.0⎥
⎢   ⎥
⎢2.0⎥
⎢   ⎥
⎣0.0⎦
</pre></div>
</div>
</div>
</div>
<p>El sistema de <strong>ecuaciones lineales</strong> a resolver es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{cccc}
2 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 2 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0
\end{array}
\right ]
\Delta x = 
-\left [
\begin{array}{c}
6 \\
6 \\
2 \\
0
\end{array}
\right ]
\end{split}\]</div>
<p><strong>Obsérvese que la última ecuación es redundante por lo que una solución al sistema anterior es considerar <span class="math notranslate nohighlight">\(x_4=0\)</span> y resolver:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{ccc}
2 &amp; 0 &amp; 0  \\
0 &amp; 2 &amp; 0  \\
0 &amp; 0 &amp; 2  \\
\end{array}
\right ]
\Delta x = 
-\left [
\begin{array}{c}
6 \\
6 \\
2 \\
\end{array}
\right ]
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p><em>SymPy</em> nos permite obtener soluciones a sistemas de ecuaciones lineales que tienen un renglón y columna de ceros.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">gf_sympy_eval</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{x₁: -3.0, x₂: -3.0, x₃: -1.0}
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Esquema iterativo: <span class="math notranslate nohighlight">\(x_1 = x_0 + \Delta x = x_0 - \nabla ^2f_o(x^{(0)})^{-1} \nabla f_o(x^{(0)})\)</span></p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_1</span> <span class="o">=</span> <span class="n">x_0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(x_1\)</span> es el óptimo del problema.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2 2 0 0]
</pre></div>
</div>
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>El número de condición es <span class="math notranslate nohighlight">\(\infty\)</span>, con el <code class="docutils literal notranslate"><span class="pre">print</span></code> de <em>SymPy</em> se ve así.</p>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">Hf_sympy_eval</span><span class="o">.</span><span class="n">condition_number</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>zoo
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]),</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<p>De acuerdo al ejemplo anterior:</p>
<ul class="simple">
<li><p>Utilizar información de primer o segundo orden nos ayuda a encontrar óptimo(s) de funciones.</p></li>
<li><p>El método de descenso en gradiente no converge para el punto inicial elegido. En el caso del método de Newton sí hay convergencia pero es lenta si el punto inicial tiene en la última entrada un número cercano a <span class="math notranslate nohighlight">\(0\)</span>.</p></li>
<li><p>Una de las ventajas que tiene utilizar la dirección del gradiente vs la dirección de Newton es que el gradiente involucra menos almacenamiento en memoria que el almacenamiento de la Hessiana: <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span> vs <span class="math notranslate nohighlight">\(\mathcal{O}(n^2)\)</span>.</p></li>
</ul>
</div>
</section>
<section id="resolviendo-el-problema-con-cvxpy">
<h3>Resolviendo el problema con <a class="reference external" href="https://github.com/cvxgrp/cvxpy"><em>CVXPY</em></a><a class="headerlink" href="#resolviendo-el-problema-con-cvxpy" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fo_cvxpy</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">x2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x3</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x4</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">fo_cvxpy</span><span class="p">)</span>

<span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;status:&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal value&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal var&quot;</span><span class="p">,</span> <span class="n">x1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">x2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">x3</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">x4</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>status: optimal
optimal value 0.0
optimal var 2.0 2.0 0.0 0.0
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="tamano-o-longitud-de-paso">
<h2>Tamaño o longitud de paso<a class="headerlink" href="#tamano-o-longitud-de-paso" title="Permalink to this headline">#</a></h2>
<p>En el ejemplo anterior en el que se aproximó al mínimo del siguiente problema con el método de Newton</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^4} (x_1-2)^2+(2-x_2)^2+x_3^2+x_4^4\]</div>
<p>se concluyó que tal método converge de forma lenta y el método de descenso en gradiente no converge para el punto inicial elegido en ambos métodos. La pequeña reducción que se obtenía en <span class="math notranslate nohighlight">\(f_o\)</span> por cada iteración fue la razón de tal situación en el caso del descenso en gradiente. Una metodología que resuelve la no convergencia del método de descenso en gradiente utiliza el siguiente esquema iterativo:</p>
<div class="math notranslate nohighlight">
\[x^{(k+1)} = x^{(k)} + t^{(k)}\Delta x\]</div>
<p>con <span class="math notranslate nohighlight">\(t^{(k)}&gt;0\)</span>.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Para el caso del método de Newton, la convergencia cuadrática depende además de elegir tamaños de pasos adecuados que:</p>
<ul class="simple">
<li><p>las iteraciones vayan aproximándose a <span class="math notranslate nohighlight">\(x^*\)</span>,</p></li>
<li><p>la función objetivo sea dos veces diferenciable y su Hessiana sea definida positiva en un conjunto abierto que contenga a <span class="math notranslate nohighlight">\(x^*\)</span> y sea <em>Lipschitz</em> continua en tal conjunto, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Lipschitz_continuity">Lipschitz_continuity </a>, que ayuda a acotar la diferencia entre <span class="math notranslate nohighlight">\(f_o\)</span> y el modelo cuadrático <span class="math notranslate nohighlight">\(m\)</span>.</p></li>
</ul>
</div>
<section id="id1">
<h3>Continuando con el ejemplo anterior<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Usando el método de descenso en gradiente de <span class="math notranslate nohighlight">\(f_o\)</span> y el esquema iterativo:</p>
<div class="math notranslate nohighlight">
\[x^{(k+1)} = x^{(k)} - t^{(k)} \nabla f_o(x^{(k)})\]</div>
<p>con <span class="math notranslate nohighlight">\(t^{(0)} = 0.5\)</span> con punto inicial <span class="math notranslate nohighlight">\(x^{(0)} = \left [ \begin{array}{c} 5 \\ 5 \\1 \\ 0.1 \\ \end{array} \right ]\)</span> se tiene:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_0</span><span class="o">=</span><span class="mf">0.5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_1</span> <span class="o">=</span> <span class="n">x_0</span> <span class="o">-</span> <span class="n">t_0</span><span class="o">*</span><span class="n">gf_eval</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.    2.    0.    0.098]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1</span> <span class="o">==</span> <span class="n">approx</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]),</span> <span class="nb">abs</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>por lo que llegamos a aproximar al óptimo en una iteración.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Para problemas <em>small scale</em> el método de Newton o Cuasi-Newton son muy superiores al método de descenso en gradiente. Sin embargo para problemas <em>large scale</em> el método de descenso en gradiente es utilizado ampliamente en aplicaciones de <em>machine learning</em>.</p>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Al escalar <span class="math notranslate nohighlight">\(t^{(k)}\)</span> se le nombra <strong>tamaño o longitud de paso</strong> y siempre es positivo salvo en el caso en que <span class="math notranslate nohighlight">\(x^{(k)}\)</span> sea óptimo.</p>
</div>
<p>El valor <span class="math notranslate nohighlight">\(t^{(k)}\)</span> se calcula con metodologías como búsqueda de línea o regiones de confianza, ver <a class="reference external" href="https://en.wikipedia.org/wiki/Line_search">line search</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Trust_region">trust region</a> y en esta nota se revisa la búsqueda de línea con <em>backtracking</em>.</p>
</section>
<section id="por-que-funciona-lo-anterior">
<h3>¿Por qué funciona lo anterior?<a class="headerlink" href="#por-que-funciona-lo-anterior" title="Permalink to this headline">#</a></h3>
<p>La condición para que una dirección produzca descenso en <span class="math notranslate nohighlight">\(f_o\)</span>, <span class="math notranslate nohighlight">\(f_o(x^{(k+1)}) &lt; f_o(x^{(k)})\)</span>, no es la única para que la secuencia de minimización converja a un mínimo de <span class="math notranslate nohighlight">\(f_o\)</span>. El siguiente ejemplo muestra el comportamiento del ejemplo trabajado antes en el plano.</p>
<p>Considérese <span class="math notranslate nohighlight">\(f_o(x) = x^2\)</span>, <span class="math notranslate nohighlight">\(x^{(0)} = 2\)</span> y los pasos dados por la secuencia: <span class="math notranslate nohighlight">\((-1)^k(1+2^{-k})\)</span>. Entonces:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_o</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">minimization_sequence</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">yield</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.3</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_o</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">f_o</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">minimization_sequence</span><span class="p">()]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Secuencia de minimización que no converge al mínimo de $f_o$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$f(x^{(0)})$&#39;</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span> <span class="n">f_o</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$f(x^{(1)})$&#39;</span><span class="p">,(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">f_o</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;$f(x^{(2)})$&#39;</span><span class="p">,(</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">f_o</span><span class="p">(</span><span class="mf">1.25</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_354_0.png" src="../../_images/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco_354_0.png" />
</div>
</div>
<p>para esta secuencia se cumple <span class="math notranslate nohighlight">\(f_o(x^{(k+1)}) &lt; f_o(x^{(k)})\)</span> por lo que es una secuencia de minimización pero no converge tal secuencia pues oscila en los valores <span class="math notranslate nohighlight">\(\approx -1, 1\)</span>.</p>
<p>El problema en este caso es que en cada iteración es muy pequeña la reducción que se obtiene en <span class="math notranslate nohighlight">\(f_o\)</span> relativo a la longitud de los pasos. Esto puede arreglarse al requerir que se cumpla una reducción en <span class="math notranslate nohighlight">\(f_o\)</span> al moverse de <span class="math notranslate nohighlight">\(f_o(x^{(k)})\)</span> hacia <span class="math notranslate nohighlight">\(f_o(x^{(k+1)})\)</span> de al menos una cantidad (reducción suficiente).</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Otra dificultad relacionada con la reducción de <span class="math notranslate nohighlight">\(f_o\)</span> y la longitud de los pasos es la situación en la que los pasos sean muy pequeños relativos a la reducción de <span class="math notranslate nohighlight">\(f_o\)</span>. En la implementación por <em>backtracking</em> que se revisa a continuación sólo se soluciona la reducción suficiente de <span class="math notranslate nohighlight">\(f_o\)</span>.</p>
</div>
</section>
</section>
<section id="metodo-de-busqueda-de-linea-por-backtracking">
<span id="mbuslinback"></span><h2>Método de búsqueda de línea por <em>backtracking</em><a class="headerlink" href="#metodo-de-busqueda-de-linea-por-backtracking" title="Permalink to this headline">#</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://en.wikipedia.org/wiki/Backtracking_line_search">Backtracking_line_search</a>.</p>
</aside>
<p>En esta sección consideramos <span class="math notranslate nohighlight">\(f = f_o\)</span>.</p>
<p>La idea del método de búsqueda de línea por <em>backtracking</em> es moverse de un punto a otro siguiendo una dirección de descenso con un tamaño de paso completo y si tal tamaño no satisface un criterio entonces realizar un <em>backtrack</em> de forma sistemática a lo largo de tal dirección hasta satisfacer el criterio resultando en el tamaño de paso correspondiente.</p>
<section id="descenso-suficiente">
<h3>Descenso suficiente<a class="headerlink" href="#descenso-suficiente" title="Permalink to this headline">#</a></h3>
<p>Para entender el método de búsqueda de línea por <em>backtracking</em> supóngase que <span class="math notranslate nohighlight">\(f\)</span> tiene una forma siguiente:</p>
<img src="https://dl.dropboxusercontent.com/s/0woqoj8foo5eco9/level_set_of_func.png?dl=0" heigth="300" width="300">
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Un rayo es el conjunto definido por <span class="math notranslate nohighlight">\(\{x + \theta v : \theta \geq 0 , v \neq 0, v \in \mathbb{R}^n\}\)</span> para <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span>.</p>
<img src="https://dl.dropboxusercontent.com/s/l3z9j49ldzknmif/ej_rayo.png?dl=0" heigth="200" width="200">
</aside>
<p>Y considérese una función <span class="math notranslate nohighlight">\(g: \mathbb{R} \rightarrow \mathbb{R}\)</span> igual a <span class="math notranslate nohighlight">\(f\)</span> pero restringida al <strong>rayo</strong> <span class="math notranslate nohighlight">\(x + t\Delta x\)</span>, esto es: <span class="math notranslate nohighlight">\(g(t) = f(x+t \Delta x)\)</span> con <span class="math notranslate nohighlight">\(t&gt;0\)</span>, <span class="math notranslate nohighlight">\(\Delta x\)</span> dirección de descenso. Lo anterior se visualiza como sigue:</p>
<img src="https://dl.dropboxusercontent.com/s/18udjmzmmd7drrz/line_search_backtracking_1.png?dl=0" heigth="300" width="300"><div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese en el dibujo que <span class="math notranslate nohighlight">\(\nabla f(x) \neq 0\)</span>.</p>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference internal" href="../../1.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#ejrestriccionalinea"><span class="std std-ref">ejemplo</span></a> de la nota <a class="reference internal" href="../../1.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html#fcd"><span class="std std-ref">Definición de función, continuidad y derivada</span></a> para expresión de la derivada <span class="math notranslate nohighlight">\(g'(t)\)</span>.</p>
</aside>
<p>Y como <span class="math notranslate nohighlight">\(f\)</span> es continua y diferenciable, <span class="math notranslate nohighlight">\(g\)</span> también lo es y <span class="math notranslate nohighlight">\(g(0)=f(x)\)</span>, <span class="math notranslate nohighlight">\(g'(t) = \nabla f(x+t\Delta x)^T \Delta x\)</span>. Si graficamos <span class="math notranslate nohighlight">\(g\)</span> se tendría:</p>
<img src="https://dl.dropboxusercontent.com/s/sgj7eqr2qysi8hs/line_search_backtracking_2.png?dl=0" heigth="300" width="300">
<p>En la búsqueda de línea se construyen dos rectas. Una recta es <span class="math notranslate nohighlight">\(g(0) + \alpha g'(0)(t-0)\)</span> con <span class="math notranslate nohighlight">\(\alpha \in (0,\frac{1}{2})\)</span>. La otra recta es <span class="math notranslate nohighlight">\(g(0)+g'(0)(t-0)\)</span>. Ambas rectas tienen pendiente negativa. Esto se visualiza como sigue:</p>
<img src="https://dl.dropboxusercontent.com/s/11y008lq0fd6jl6/line_search_backtracking_3.png?dl=0" heigth="500" width="500">
<p>Se busca <span class="math notranslate nohighlight">\(t^{(k)}\)</span> tal que <span class="math notranslate nohighlight">\(f\)</span> <strong>decrezca suficientemente</strong>. Lo anterior se establece con la desigualdad:</p>
<div class="math notranslate nohighlight">
\[f(x+t \Delta x) &lt; f(x) + \alpha t \nabla f(x)^T \Delta x\]</div>
<p>que se nombra <strong>condición de Armijo</strong>:</p>
<img src="https://dl.dropboxusercontent.com/s/o4f341x1y5sqxt8/line_search_backtracking_4.png?dl=0" heigth="500" width="500">
<p>Obsérvese en el dibujo anterior que la región en la que se elegirá <span class="math notranslate nohighlight">\(t^{(k)}\)</span> está a la izquierda de la línea punteada vertical de color verde.</p>
<p>Y visualmente en <span class="math notranslate nohighlight">\(R^3\)</span> se tiene:</p>
<img src="https://dl.dropboxusercontent.com/s/t3yn7kkpd4il8hx/line_search_backtracking_5.png?dl=0" heigth="300" width="300">
</section>
<section id="algoritmo-busqueda-de-linea-por-backtracking">
<h3>Algoritmo: búsqueda de línea por <em>backtracking</em><a class="headerlink" href="#algoritmo-busqueda-de-linea-por-backtracking" title="Permalink to this headline">#</a></h3>
<p>El método depende de dos constantes <span class="math notranslate nohighlight">\(\alpha\)</span> y <span class="math notranslate nohighlight">\(\beta\)</span> con <span class="math notranslate nohighlight">\(\alpha \in (0,\frac{1}{2})\)</span> y <span class="math notranslate nohighlight">\(\beta \in (0,1)\)</span>.</p>
<blockquote>
<div><p><strong>Dados</strong> <span class="math notranslate nohighlight">\(\Delta x\)</span> dirección de descenso para <span class="math notranslate nohighlight">\(f\)</span> en <span class="math notranslate nohighlight">\(x \in \text{dom}f\)</span>, <span class="math notranslate nohighlight">\(\alpha \in (0,\frac{1}{2})\)</span>, <span class="math notranslate nohighlight">\(\beta \in (0,1)\)</span>.</p>
<p><strong>Asignar</strong> t=1.</p>
<p><strong>Mientras</strong> <span class="math notranslate nohighlight">\(f(x+t\Delta x) &gt; f(x) + \alpha t \nabla f(x) ^T\Delta x\)</span>.</p>
<blockquote>
<div><ol class="simple">
<li><p><strong>Reducir</strong> <span class="math notranslate nohighlight">\(t: t= \beta t\)</span>.</p></li>
</ol>
</div></blockquote>
</div></blockquote>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La desigualdad de descenso suficiente establece que la reducción debe ser proporcional al tamaño de paso y la derivada direccional <span class="math notranslate nohighlight">\(\nabla f(x)^T \Delta x\)</span>.</p></li>
<li><p>El <em>backtracking</em> permite tomar tamaños de paso completos, esto es, <span class="math notranslate nohighlight">\(t = 1\)</span>.</p></li>
<li><p>El valor <span class="math notranslate nohighlight">\(\alpha\)</span> típicamente se elige entre <span class="math notranslate nohighlight">\(.01\)</span> y <span class="math notranslate nohighlight">\(.3\)</span> que indica que se acepta un decrecimiento en el valor de <span class="math notranslate nohighlight">\(f\)</span> entre el <span class="math notranslate nohighlight">\(1 \%\)</span> y el <span class="math notranslate nohighlight">\(30 \%\)</span>. La constante <span class="math notranslate nohighlight">\(\beta\)</span> comúnmente se elige entre <span class="math notranslate nohighlight">\(.1\)</span> (que modifica fuertemente <span class="math notranslate nohighlight">\(t\)</span>) y <span class="math notranslate nohighlight">\(.8\)</span> (que realiza una modificación menos drástica de <span class="math notranslate nohighlight">\(t\)</span>).</p></li>
<li><p>Aunque la condición de descenso suficiente por sí sola no garantiza que un algoritmo que la utilice realice progreso razonable (pues también hay que añadir una segunda condición para no tomar valores de <span class="math notranslate nohighlight">\(t\)</span> muy pequeños) en la implementación del <em>backtracking</em> puede incluirse que se revise que <span class="math notranslate nohighlight">\(t\)</span> no sea muy pequeño (por ejemplo menor a <span class="math notranslate nohighlight">\(10^{-6}\)</span>) relativo a <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(\Delta x\)</span> y <span class="math notranslate nohighlight">\(\nabla f(x)\)</span>.</p></li>
</ul>
</div>
</section>
</section>
<section id="funcion-en-python-para-el-metodo-de-backtracking">
<h2>Función en Python para el método de <em>backtracking</em><a class="headerlink" href="#funcion-en-python-para-el-metodo-de-backtracking" title="Permalink to this headline">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">line_search_by_backtracking</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">dir_desc</span><span class="p">,</span><span class="n">x</span><span class="p">,</span>
                                <span class="n">der_direct</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.15</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Line search that sufficiently decreases f restricted to a ray in the direction dir_desc.</span>
<span class="sd">    Args:</span>
<span class="sd">        alpha (float): parameter in line search with backtracking, tipically .15</span>
<span class="sd">        beta (float): parameter in line search with backtracking, tipically .5</span>
<span class="sd">        f (lambda expression): definition of function f.</span>
<span class="sd">        dir_desc (array): descent direction.</span>
<span class="sd">        x (array): numpy array that holds values where line search will be performed.</span>
<span class="sd">        der_direct (float): directional derivative of f.</span>
<span class="sd">    Returns:</span>
<span class="sd">        t (float): positive number for stepsize along dir_desc that sufficiently decreases f.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;alpha must be less than or equal to 1/2&quot;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">beta</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beta must be less than 1&quot;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>   
    <span class="k">if</span> <span class="n">t</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">eval1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">dir_desc</span><span class="p">)</span>
        <span class="n">eval2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">der_direct</span>
        <span class="k">while</span> <span class="n">eval1</span> <span class="o">&gt;</span> <span class="n">eval2</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="n">t</span>
            <span class="n">eval1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">dir_desc</span><span class="p">)</span>
            <span class="n">eval2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">alpha</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">der_direct</span>
    <span class="k">return</span> <span class="n">t</span>
</pre></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Realizar <span class="math notranslate nohighlight">\(5\)</span> iteraciones para minimizar la función <span class="math notranslate nohighlight">\(log(e^{x_1^2} + e^{x_2^2})\)</span> del método de descenso en gradiente utilizando búsqueda de línea tomando como punto inicial <span class="math notranslate nohighlight">\((10,1)\)</span> y calcular el error relativo de cada iteración. Para calcular <span class="math notranslate nohighlight">\(x^*\)</span> utilizar <a class="reference external" href="https://github.com/cvxgrp/cvxpy">cvxpy</a>.</p>
</div>
</section>
<section id="algoritmo-metodo-general-de-descenso-para-problemas-uco">
<span id="metgendescparauco"></span><h2>Algoritmo: método general de descenso para problemas UCO<a class="headerlink" href="#algoritmo-metodo-general-de-descenso-para-problemas-uco" title="Permalink to this headline">#</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los pasos de un algoritmo representan una guía para la implementación, no implica que se tengan que implementar uno a continuación del otro como se describe. Si una implementación respeta la lógica y al mismo algoritmo, entonces pueden seguirse los pasos de una forma distinta.</p>
</aside>
<blockquote>
<div><p><strong>Dado</strong> un <strong>punto inicial</strong> <span class="math notranslate nohighlight">\(x\)</span> en <span class="math notranslate nohighlight">\(\text{dom}f_o\)</span></p>
<p><strong>Repetir</strong> el siguiente bloque para <span class="math notranslate nohighlight">\(k=0,1,2, \dots\)</span></p>
<blockquote>
<div><ol class="simple">
<li><p>Determinar una dirección de descenso <span class="math notranslate nohighlight">\(\Delta x\)</span>.</p></li>
<li><p>Búsqueda de línea. Elegir un tamaño de paso <span class="math notranslate nohighlight">\(t &gt; 0\)</span>.</p></li>
<li><p>Hacer la actualización: <span class="math notranslate nohighlight">\(x = x + t\Delta x\)</span>.</p></li>
</ol>
</div></blockquote>
<p><strong>hasta</strong> convergencia (satisfacer criterio de paro).</p>
</div></blockquote>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios.</p>
<ul class="simple">
<li><p>El algoritmo termina si <span class="math notranslate nohighlight">\(f_o(x^{(k)})-p^* \leq \epsilon\)</span> con <span class="math notranslate nohighlight">\(\epsilon &gt;0\)</span>, esto es, <span class="math notranslate nohighlight">\(x^{(k)}\)</span> es <span class="math notranslate nohighlight">\(\epsilon\)</span>-subóptimo.</p></li>
<li><p>El criterio de paro típicamente es de la forma <span class="math notranslate nohighlight">\(||\nabla f_o(x)|| \leq tol\)</span> donde: <span class="math notranslate nohighlight">\(tol\)</span> es una cantidad pequeña y positiva (comúnmente menor o igual a <span class="math notranslate nohighlight">\(10^{-8}\)</span>). También se involucra el número máximo de iteraciones en el criterio de paro.</p></li>
<li><p>El paso <span class="math notranslate nohighlight">\(2\)</span> busca reducir <span class="math notranslate nohighlight">\(f_o\)</span> lo <strong>suficiente</strong> o minimizarla aproximadamente a lo largo de un rayo. La <strong>búsqueda de línea por <a class="reference external" href="https://en.wikipedia.org/wiki/Backtracking_line_search"><em>backtracking</em></a></strong> permite esto.</p></li>
</ul>
</div>
<p><strong>Preguntas de comprehensión.</strong></p>
<p>1)¿Qué es un método de descenso?</p>
<p>2)Describe los elementos del esquema iterativo de un método de descenso.</p>
<p>3)¿Cómo se obtiene la dirección de Newton en un método de descenso?</p>
<p>4)¿Cómo se obtiene la dirección del gradiente en un método de descenso?</p>
<p>5)¿Qué es un método Cuasi-Newton?</p>
<p>6)¿Cuál es la condición matemática y geométrica que verifica que un paso de búsqueda sea de descenso?</p>
<p>7)¿Qué problemática está resolviendo el método de búsqueda de línea con <em>backtracking</em> en cuanto la reducción que se obtiene en <span class="math notranslate nohighlight">\(f_o\)</span> relativo a la longitud de los pasos?</p>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>S. P. Boyd, L. Vandenberghe, Convex Optimization, Cambridge University Press, 2009.</p></li>
<li><p>J. Dennis, R. B. Schnabel, Numerical Methods for Unconstrained Optimization and Nonlinear Equations, SIAM, 1996.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./3.optimizacion_convexa/3.2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">3.1 Definición de problemas de optimización, conjuntos y funciones convexas</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3.3 Ejemplos de problemas UCO, introducción a <em>Constrained Inequality and Equality Optimization</em> (CIEO) y puntos interiores</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Erick Palacios Moreno<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>